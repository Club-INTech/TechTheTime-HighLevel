\hypertarget{SerialPort_8hpp_source}{}\doxysection{Serial\+Port.\+hpp}
\label{SerialPort_8hpp_source}\index{src/microcontroller\_proxy/src/serial/SerialPort.hpp@{src/microcontroller\_proxy/src/serial/SerialPort.hpp}}
\mbox{\hyperlink{SerialPort_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef SCOM\_SERIAL\_PORT\_HPP}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define SCOM\_SERIAL\_PORT\_HPP}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <cstdio>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <fcntl.h>} }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <errno.h>} }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <termios.h>} }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <unistd.h>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <initializer\_list>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <upd/format.hpp>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <rpc/def.hpp>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <rpc/master.hpp>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <k2o/dispatcher.hpp>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacescom}{scom}} \{}
\DoxyCodeLine{23 }
\DoxyCodeLine{24     \textcolor{keyword}{extern} uint8\_t \mbox{\hyperlink{namespacescom_a72fdcd659d7ad96096280f70fb698cf9}{stuffing\_byte}};}
\DoxyCodeLine{25     \textcolor{comment}{// extern k2o::dispatcher dispatcher;}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27     \textcolor{keyword}{enum class} \mbox{\hyperlink{namespacescom_a6b62e2aa725ea6f1e3659baf40c782f0}{BlockingModes}} \{}
\DoxyCodeLine{28         \mbox{\hyperlink{namespacescom_a6b62e2aa725ea6f1e3659baf40c782f0a424aa3a69b1e6521fff2b1ced225c793}{NO\_BLOCK}},}
\DoxyCodeLine{29         \mbox{\hyperlink{namespacescom_a6b62e2aa725ea6f1e3659baf40c782f0aacde326a8c19aaaa30fe0a55bccf51bf}{FIXED\_BYTES}},}
\DoxyCodeLine{30         \mbox{\hyperlink{namespacescom_a6b62e2aa725ea6f1e3659baf40c782f0a070a0fb40f6c308ab544b227660aadff}{TIMEOUT}},}
\DoxyCodeLine{31         \mbox{\hyperlink{namespacescom_a6b62e2aa725ea6f1e3659baf40c782f0a8f2792ac2396044b8ac74acae3d26c71}{TIMEOUT\_WITH\_FIXED\_BYTES}}}
\DoxyCodeLine{32     \};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \textcolor{keyword}{extern} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacescom_a76fdb3799d49c97e26f5a07894b94509}{control\_mode\_bytes}}[];}
\DoxyCodeLine{35     \textcolor{keyword}{extern} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacescom_aa634905dff5990ae520fa706c84bdefc}{local\_modes\_bytes}}[];}
\DoxyCodeLine{36     \textcolor{keyword}{extern} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacescom_a2fd8adf1eef72a9af2ab67b8d0457eb7}{input\_modes\_bytes}}[];}
\DoxyCodeLine{37     \textcolor{keyword}{extern} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacescom_a8355fef72e1272a586eeabc698df5461}{output\_modes\_bytes}}[];}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 }
\DoxyCodeLine{45     \textcolor{keyword}{class }\mbox{\hyperlink{classscom_1_1SerialPort}{SerialPort}} \{}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     \textcolor{keyword}{public}:}
\DoxyCodeLine{48         \mbox{\hyperlink{classscom_1_1SerialPort_af47dc896cd7ead140472b654336c00e9}{SerialPort}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}*);}
\DoxyCodeLine{49         \mbox{\hyperlink{classscom_1_1SerialPort_a2b6b140db54cfaeaec35556d5e9a460b}{\string~SerialPort}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a81c40f110274c3f06f4d852e833f0f07}{open\_serial}}();}
\DoxyCodeLine{53         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a2d55254350a6dab689af1cc0b7b84dd6}{set\_config}}();}
\DoxyCodeLine{54         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a10bf21e5f1b4c33662cb654498394a36}{get\_config}}();}
\DoxyCodeLine{55 }
\DoxyCodeLine{56         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a8bd9905bb763c730590eef6b4e8f8d2e}{set\_input\_speed}}(speed\_t);}
\DoxyCodeLine{57         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a3fe8b479d55aac52892dfe61921f3529}{set\_output\_speed}}(speed\_t);}
\DoxyCodeLine{58 }
\DoxyCodeLine{59         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_ae332f496b770f32edbaec05eb38102b9}{define\_blocking\_mode}}(\mbox{\hyperlink{namespacescom_a6b62e2aa725ea6f1e3659baf40c782f0}{BlockingModes}}, std::initializer\_list<int>);}
\DoxyCodeLine{60 }
\DoxyCodeLine{61         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a60c866ba56912e318c8a9f71612f7604}{configure\_control\_modes}}(tcflag\_t, std::initializer\_list<bool>);}
\DoxyCodeLine{62         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a822e6c3c553ab0719aa9050a0cd59cfe}{configure\_local\_modes}}(std::initializer\_list<bool>);}
\DoxyCodeLine{63         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a57de98df60d017102338ad797c9d7a4e}{configure\_input\_modes}}(std::initializer\_list<bool>);}
\DoxyCodeLine{64         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_aac3dfde991a49a273b63e8a7f9ae11ee}{configure\_output\_modes}}(std::initializer\_list<bool>);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_aaaaf5c43ef28d9c6d9afa743f2039879}{write\_byte}}(uint8\_t*);}
\DoxyCodeLine{67         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_aa6b7b06eaa3bbff90e1ebfac98f1ebd1}{write\_word}}(uint8\_t*, \textcolor{keywordtype}{int});}
\DoxyCodeLine{68 }
\DoxyCodeLine{69         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a4efd55da26ee8b05e50afedae1562609}{read\_byte}}(uint8\_t*);}
\DoxyCodeLine{70         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_aff67b8e9f3ef69add5fd6dc1146ca315}{read\_word}}(uint8\_t*, \textcolor{keywordtype}{int});}
\DoxyCodeLine{71 }
\DoxyCodeLine{72         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a88308319742fd438b1da9055039ac554}{close\_port}}();}
\DoxyCodeLine{73         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a29604f09572b270405c7f27065ab593a}{set\_exclusive\_access}}();}
\DoxyCodeLine{74 }
\DoxyCodeLine{75         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_ac4458010bd7e641756ffcaec965cb6df}{set\_default\_config}}();}
\DoxyCodeLine{76 }
\DoxyCodeLine{77         \textcolor{keyword}{template}<\textcolor{keyword}{auto}\& Ftor, \textcolor{keyword}{typename}... Args>}
\DoxyCodeLine{78         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a3af519993320f1e8e1958bcaa4cc0209}{call\_remote\_function}}(Args\&\&... args) \{}
\DoxyCodeLine{79             \textcolor{keyword}{auto} key = rpc::master::keyring.get<Ftor>();}
\DoxyCodeLine{80             this-\/>\mbox{\hyperlink{classscom_1_1SerialPort_ad9157c7e3130e81df2952e34fdbae182}{com\_start\_frame\_transmission}}(rpc::Frame\_Type::REQUEST);}
\DoxyCodeLine{81             key(std::forward<Args>(args)...) >> [\&](upd::byte\_t byte)\{this-\/>\mbox{\hyperlink{classscom_1_1SerialPort_a5433faff286ebdf149b828a43e39db6e}{com\_write\_byte}}(\textcolor{keywordtype}{byte});\};}
\DoxyCodeLine{82         \}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keyword}{private}:}
\DoxyCodeLine{85         \textcolor{keywordtype}{int} \mbox{\hyperlink{classscom_1_1SerialPort_a03dc6e1e6df1e9a8f6c4b8f725b748fc}{serial\_port}} = -\/1;}
\DoxyCodeLine{86         \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{classscom_1_1SerialPort_af6cfe3efd0659c63865319f3b6e25eff}{port\_name}} = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{87         \textcolor{keyword}{struct }termios \mbox{\hyperlink{classscom_1_1SerialPort_a218f4d96bc6c845ab5a06d88c5ce4eaf}{serial\_port\_config}};}
\DoxyCodeLine{88         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classscom_1_1SerialPort_aea2a0a3beefd206e58a5c08cfaf25d62}{write\_stuff\_counter}};}
\DoxyCodeLine{89 }
\DoxyCodeLine{90         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_a5433faff286ebdf149b828a43e39db6e}{com\_write\_byte}}(upd::byte\_t \textcolor{keywordtype}{byte});}
\DoxyCodeLine{91         \textcolor{keywordtype}{void} \mbox{\hyperlink{classscom_1_1SerialPort_ad9157c7e3130e81df2952e34fdbae182}{com\_start\_frame\_transmission}}(rpc::Frame\_Type);}
\DoxyCodeLine{92     \};}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{98 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
